# performace_monitor
Continuously monitor the value of CPU, memory, IO of the specified port or PID or system in the Linux system.
Monitor can be started or stopped at any time. And plotting them.<br>

It can monitor linux system's free memory, when free memory is too low, it can clear cache or email to you.<br>
It can monitor gc for java's applications, when the frequency of full gc, it can email to you.<br>

## Usage
1. Clone performance_monitor repository
   ```shell
   git clone https://github.com/leeyoshinari/performance_monitor.git
   cd performance_monitor
   ```

2. Modify `config.py`.
   
3. Ensure which disk your application runs, or which disk your application reads and writes. And then, set the name of disk into `config.py`.

4. If you want to email to you when memory and gc's frequency wrong, please set `PASSWORD` in `config.py`, the password is generated by `GenerateKey.py`. Meanwhile, you must modify `GenerateKey.py` and `PwdEncrypt.py` to protect your password.<br>

5. Run
   ```shell
   python3 server.py
   ```
   or
   ```shell
   nohup python3 server.py &
   ```

6. Start monitor<br>
   Enter `http://ip:port/startMonitor?isRun=1&type=port&num=9999` in browser<br>
   param:<br>
   &emsp;&emsp;`isRun=0`: stop monitor the `port`; `isRun=1`: start monitor the `port`.<br>
   &emsp;&emsp;`type=port` means the `num` is port. `type=pid` means the `num` is pid. The `num` can be specified only one. If you wait to monitor other `port`, please send http request again.<br>
   
7. Plotting<br>
   Enter `http://ip:port/plotMonitor?type=port&num=9999&startTime=2019-10-01 10:00:00&duration=3600&showIO=1` in browser<br>
   or `http://ip:port/plotMonitor?startTime=2019-10-01 10:00:00&duration=3600&system=1`<br>
   param:<br>
   &emsp;&emsp;`type=port` means the `num` is port. `type=pid` means the `num` is pid. If type is port, plotting all results of `port`, if type is pid, plotting all results of `pid`.<br>
   &emsp;&emsp;`system` means plot system's cpu and free memory.<br>
   &emsp;&emsp;`showIO` means calculate IO(%) when `system` is None. it's not necessary.<br>
   &emsp;&emsp;`startTime` and `duration` are optional parameters, if you plot last monitor, they are not needed, but if you want to plot over a period of time, they are needed. `duration` is second. The range of a period of time is `startTime + duration`. `startTime` must be accurate, if you're not sure it, please see the last line of `startTime.txt` or logs.

8. Get monitoring list<br>
   Enter `http://ip:port/getMonitorList?type=1` in browser.<br>
   Param:<br>
   &emsp;&emsp;`type` is an optional parameter. `type=1` means get monitoring ports and pids list. If not `type`, means get all ports and pids list.

## Note
1. Your Linux must support the `jstat`, `top`, `iostat` and `netstat` commands, if not, please install them.

2. For more information, please [read me](https://blog.csdn.net/leeyoshinari/article/details/98248304).

3. If you don't know how to install Python 3.7+ in Linux, please [read me](https://blog.csdn.net/leeyoshinari/article/details/95805478)

## Requirements
1. flask
2. matplotlib
3. Python 3.7+
